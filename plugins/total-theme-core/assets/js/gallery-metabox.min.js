!function(r,o){"use strict";r(document).ready(function(){var t,i=r("#wpex_image_gallery_field"),l=r("#wpex_gallery_images_container ul.wpex_gallery_images");jQuery(".add_wpex_gallery_images").on("click","a",function(e){e.preventDefault();var a=i.val();t||(t=wp.media.frames.image_gallery_frame=wp.media({frame:"post",title:o.title,button:{text:o.button},library:{type:"image"},multiple:!0,filterable:"all"})).on("insert",function(){t.state().get("selection").map(function(e){(e=e.toJSON()).id&&(a=a?a+","+e.id:e.id,l.append('<li class="image" data-attachment_id="'+e.id+'"><div class="attachment-preview"><div class="thumbnail"><img src="'+e.url+'" /></div><a href="#" class="wpex-gmb-remove">'+o.remove+"</a></div></li>"))}),i.val(a)}),t.open()}),l.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"wpex-metabox-sortable-placeholder",start:function(e,a){a.item.css("background-color","#f6f6f6")},stop:function(e,a){a.item.removeAttr("style")},update:function(e,a){var t="";r("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");t=t+e+","}),i.val(t)}}),r("#wpex_gallery_images_container").on("click","a.wpex-gmb-remove",function(){r(this).closest("li.image").remove();var a="";return r("#wpex_gallery_images_container ul li.image").css("cursor","default").each(function(){var e=jQuery(this).attr("data-attachment_id");a=a+e+","}),i.val(a),!1})})}(jQuery,wpexGalleryMetabox);